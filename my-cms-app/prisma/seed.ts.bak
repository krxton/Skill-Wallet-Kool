import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸£à¸²à¸ˆà¸° Mockup
const parentData = [
  { id: 'PR1', fullName: 'à¸„à¸±à¸™à¸˜à¸²à¸£à¸±à¸•à¸™à¹Œ à¸­à¹€à¸™à¸à¸šà¸¸à¸“à¸¢à¹Œ', email: 'khantharat.a@sci.kmutnb.ac.th' },
  { id: 'PR2', fullName: 'à¸ªà¸¸à¸§à¸±à¸ˆà¸Šà¸±à¸¢ à¸à¸¡à¸¥à¸ªà¸±à¸™à¸•à¸´à¹‚à¸£à¸ˆà¸™à¹Œ', email: 'suwatchai.k@sci.kmutnb.ac.th' },
  { id: 'PR3', fullName: 'à¸˜à¸£à¸£à¸¨à¸à¸ à¸“ à¸ªà¸¸à¸£à¸°à¸¨à¸±à¸à¸”à¸´à¹Œ', email: 'thattapon.s@sci.kmutnb.ac.th' },
];

const childData = [
  { id: 'CH1', fullName: 'à¸“à¸±à¸à¸´à¸§à¸¸à¸’à¸´ à¸ªà¸³à¹€à¸ à¸²à¸žà¸±à¸™à¸˜à¹Œ', dob: new Date('2004-05-12'), score: 180 },
  { id: 'CH2', fullName: 'à¸“à¸±à¸à¸à¸“à¸´à¸Šà¸² à¸­à¹ˆà¸­à¸™à¸ªà¸¸à¸§à¸£à¸£à¸“à¹Œ', dob: new Date('2004-05-20'), score: 540 },
  { id: 'CH3', fullName: 'à¸“à¸±à¸à¸Šà¸™à¸™ à¸žà¸¹à¸¥à¹€à¸žà¸´à¹ˆà¸¡', dob: new Date('2003-09-12'), score: 600 },
  { id: 'CH4', fullName: 'à¸à¸¤à¸•à¸“à¸±à¸ à¸ªà¸²à¹‚à¸–à¸™', dob: new Date('2003-03-10'), score: 720 },
];

const parentChildData = [
  { parentId: 'PR1', childId: 'CH1', relationship: 'à¸¡à¸²à¸£à¸”à¸²' },
  { parentId: 'PR2', childId: 'CH2', relationship: 'à¸šà¸´à¸”à¸²' },
  { parentId: 'PR2', childId: 'CH3', relationship: 'à¸šà¸´à¸”à¸²' },
  { parentId: 'PR3', childId: 'CH4', relationship: 'à¸šà¸´à¸”à¸²' },
];

const rewardData = [
    { id: 'RW1', name: 'YouTube : 30 à¸™à¸²à¸—à¸µ', cost: 120 }, 
    { id: 'RW2', name: 'à¸•à¸¸à¹Šà¸à¸•à¸²à¸«à¸¡à¸µ : 1 à¸•à¸±à¸§', cost: 420 },
    { id: 'RW3', name: 'à¸à¸±à¸™à¸”à¸£à¸±à¸¡ : 1 à¸•à¸±à¸§', cost: 680 },
];

const parentRewardData = [
    { parentId: 'PR1', rewardId: 'RW1' },
    { parentId: 'PR2', rewardId: 'RW2' },
    { parentId: 'PR3', rewardId: 'RW3' },
];

// ðŸ—‘ï¸ à¸¥à¸šà¸ªà¹ˆà¸§à¸™à¸™à¸µà¹‰à¸­à¸­à¸ - à¹„à¸¡à¹ˆà¸ªà¸£à¹‰à¸²à¸‡ Activity à¹ƒà¸™ seed à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸›
// const activityData = [...];

async function main() {
  console.log(`ðŸŒ± Start seeding ...`);

  // *** 1. à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¹ˆà¸²à¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸š (à¸¥à¸³à¸”à¸±à¸šà¸ªà¸³à¸„à¸±à¸à¸¡à¸²à¸) ***
  console.log('ðŸ—‘ï¸  Deleting old data...');
  
  await prisma.activity_record.deleteMany({});     // 1. ActivityRecord
  console.log('   âœ… Deleted ActivityRecords');

  await prisma.redemption.deleteMany({});   // 2. Redemption
  console.log('   âœ… Deleted Redemptions');

  await prisma.parent_and_medals.deleteMany({});       // 3. ParentAndMedals
  console.log('   âœ… Deleted ParentAndMedals');

  await prisma.parent_and_child.deleteMany({});        // 4. ParentAndChild
  console.log('   âœ… Deleted ParentAndChild');

  // à¸¥à¸š Entity à¸«à¸¥à¸±à¸ (à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¸•à¸²à¸£à¸²à¸‡à¸—à¸µà¹ˆà¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¸–à¸¹à¸à¸¥à¸šà¹à¸¥à¹‰à¸§)
  await prisma.medals.deleteMany({});             // 5. Medals
  console.log('   âœ… Deleted Medals');
  
  await prisma.activity.deleteMany({});           // 6. Activity
  console.log('   âœ… Deleted Activities');
  
  await prisma.child.deleteMany({});              // 7. Child
  console.log('   âœ… Deleted Children');
  
  await prisma.parent.deleteMany({});             // 8. Parent
  console.log('   âœ… Deleted Parents');

  console.log('âœ¨ Old data deleted.\n');

  // 2. à¸ªà¸£à¹‰à¸²à¸‡ Parent (à¸œà¸¹à¹‰à¸›à¸à¸„à¸£à¸­à¸‡)
  for (const p of parentData) {
    await prisma.parent.create({
      data: {
        id: p.id,
        fullName: p.fullName,
        email: p.email,
      },
    });
  }
  console.log('âœ… Parents created.');

  // 3. à¸ªà¸£à¹‰à¸²à¸‡ Child (à¹€à¸”à¹‡à¸)
  for (const c of childData) {
    await prisma.child.create({
      data: {
        id: c.id,
        fullName: c.fullName,
        dob: c.dob,
        score: c.score,
      },
    });
  }
  console.log('âœ… Children created.');
  
  // 4. à¸ªà¸£à¹‰à¸²à¸‡ ParentChild (à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œ)
  for (const pc of parentChildData) {
    await prisma.parentChild.create({
      data: pc,
    });
  }
  console.log('âœ… ParentChild relations created.');

  // 5. à¸ªà¸£à¹‰à¸²à¸‡ Reward (à¸‚à¸­à¸‡à¸£à¸²à¸‡à¸§à¸±à¸¥)
  for (const r of rewardData) {
    await prisma.reward.create({
      data: r,
    });
  }
  console.log('âœ… Rewards created.');
  
  // 6. à¸ªà¸£à¹‰à¸²à¸‡ ParentReward (à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¸œà¸¹à¹‰à¸›à¸à¸„à¸£à¸­à¸‡à¸à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥)
  for (const pr of parentRewardData) {
      await prisma.parentReward.create({
          data: pr,
      });
  }
  console.log('âœ… ParentReward relations created.');

  // ðŸ†• 7. à¹„à¸¡à¹ˆà¸ªà¸£à¹‰à¸²à¸‡ Activity - à¸ˆà¸°à¸ªà¸£à¹‰à¸²à¸‡à¸œà¹ˆà¸²à¸™ CMS
  console.log('ðŸ“ Activities: Ready to create via CMS\n');

  console.log('ðŸŽ‰ Seeding finished successfully!');
}

main()
  .catch((e) => {
    console.error('âŒ Seeding failed:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });